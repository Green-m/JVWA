package com.ffffffff0x.exploit;

import com.ffffffff0x.exploit.p.entity.UserPrimary;
import com.ffffffff0x.exploit.p.mapper.UserMapperPrimary;
import com.ffffffff0x.exploit.s.mapper.UserMapperSecondary;
import io.swagger.annotations.Api;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Api(tags = "用户管理")
@RestController
public class UserController {

    @Autowired
    private UserMapperPrimary userMapperPrimary;

    // 查询所有用户
    @GetMapping("/user/mysql/alluser")
    public List<UserPrimary> AllUser() {
        return userMapperPrimary.AllUser();
    }

    // 查询指定用户
    // http://127.0.0.1:8777/user/mysql/getbyid/1 or 1=1
    @GetMapping("/user/mysql/getbyid/{id}")
    public List<UserPrimary> getById(@PathVariable String id) {
        return userMapperPrimary.findById(id);
    }

    // 创建用户
    @PostMapping("/user/mysql/create")
    public int create(@RequestBody UserPrimary userPrimary) {
        return userMapperPrimary.insert(userPrimary.getName(), userPrimary.getAge());
    }

    @Autowired
    private UserMapperSecondary userMapperSecondary;

    // 查询所有用户
    // http://127.0.0.1:8777/user/postgre/getbyid/1 or 1=1
    @GetMapping("/user/postgre/alluser")
    public List<UserPrimary> PostgreAllUser() {
        return userMapperSecondary.AllUser();
    }

    // 查询指定用户
    @GetMapping("/user/postgre/getbyid/{id}")
    public List<UserPrimary> PostgregetById(@PathVariable String id) {
        return userMapperSecondary.findById(id);
    }

    // 创建用户
    @PostMapping("/user/postgre/create")
    public int Postgrecreate(@RequestBody UserPrimary userPrimary) {
        return userMapperSecondary.insert(userPrimary.getName(), userPrimary.getAge());
    }

}
