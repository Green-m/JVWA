package com.ffffffff0x.exploit;

import com.ffffffff0x.exploit.p.entity.UserPrimary;
import com.ffffffff0x.exploit.p.mapper.UserMapperPrimary;
import com.ffffffff0x.exploit.s.mapper.UserMapperSecondary;
import io.swagger.annotations.Api;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Api(tags = "SQL注入")
@RestController
@RequestMapping("/sqlinj")
public class SQLinj {

    @Autowired
    private UserMapperPrimary userMapperPrimary;

    // 查询所有用户
    @GetMapping("/mysql/alluser")
    public List<UserPrimary> AllUser() {
        return userMapperPrimary.AllUser();
    }

    // 查询指定用户
    // http://127.0.0.1:8999/sqlinj/mysql/getbyid/1 or 1=1
    @GetMapping("/mysql/getbyid/{id}")
    public List<UserPrimary> getById(@PathVariable String id) {
        return userMapperPrimary.findById(id);
    }

    // 创建用户
    @PostMapping("/mysql/create")
    public int create(@RequestBody UserPrimary userPrimary) {
        return userMapperPrimary.insert(userPrimary.getName(), userPrimary.getAge());
    }

    @Autowired
    private UserMapperSecondary userMapperSecondary;

    // 查询所有用户
    // http://127.0.0.1:8999/sqlinj/postgre/getbyid/1 or 1=1
    @GetMapping("/postgre/alluser")
    public List<UserPrimary> PostgreAllUser() {
        return userMapperSecondary.AllUser();
    }

    // 查询指定用户
    @GetMapping("/postgre/getbyid/{id}")
    public List<UserPrimary> PostgregetById(@PathVariable String id) {
        return userMapperSecondary.findById(id);
    }

    // 创建用户
    @PostMapping("/postgre/create")
    public int Postgrecreate(@RequestBody UserPrimary userPrimary) {
        return userMapperSecondary.insert(userPrimary.getName(), userPrimary.getAge());
    }

}
